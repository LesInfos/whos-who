{"ast":null,"code":"import _asyncToGenerator from \"M:/August Cohort/angular-whos-who-aug-2024-team-4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { request } from \"../../services/api\";\nimport { Validators } from \"@angular/forms\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../components/button/button.component\";\n\nfunction HomeComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Loading...\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_div_6_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const genre_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", genre_r5);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", genre_r5, \" \");\n  }\n}\n\nfunction HomeComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \" Genre: \");\n    i0.ɵɵelementStart(2, \"select\", 9);\n    i0.ɵɵelement(3, \"option\", 10);\n    i0.ɵɵtemplate(4, HomeComponent_div_6_option_4_Template, 2, 2, \"option\", 11);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.form);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.genres);\n  }\n}\n\nfunction HomeComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \" Difficulty: \");\n    i0.ɵɵelementStart(2, \"select\", 12)(3, \"option\", 13);\n    i0.ɵɵtext(4, \"Easy\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"option\", 14);\n    i0.ɵɵtext(6, \"Medium\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"option\", 15);\n    i0.ɵɵtext(8, \"Hard\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r2.form);\n  }\n}\n\nfunction HomeComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"p\");\n    i0.ɵɵtext(2, \"Please select a genre before starting the game.\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nconst AUTH_ENDPOINT = \"https://nuod0t2zoe.execute-api.us-east-2.amazonaws.com/FT-Classroom/spotify-auth-token\";\nconst TOKEN_KEY = \"whos-who-access-token\";\nexport class HomeComponent {\n  constructor(router, fb) {\n    var _this = this;\n\n    this.router = router;\n    this.fb = fb;\n    this.showError = false;\n    this.genres = [];\n    this.selectedGenre = \"\";\n    this.selectedDifficulty = \"medium\";\n    this.authLoading = false;\n    this.configLoading = false;\n    this.token = \"\";\n\n    this.loadGenres = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (t) {\n        _this.configLoading = true;\n        _this.genres = [\"Pop\", \"Rock\", \"J-pop\", \"Country\", \"HipHop\", \"EDM\"];\n        _this.configLoading = false;\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    this.form = this.fb.group({\n      genre: [\"\", Validators.required],\n      difficulty: [this.selectedDifficulty, Validators.required]\n    });\n  }\n\n  ngOnInit() {\n    // Subscribe to valueChanges to call setGenre() whenever the genre changes\n    this.form.get(\"genre\")?.valueChanges.subscribe(value => {\n      this.setGenre(value);\n    }); // Subscribe to valueChanges to call setDifficulty() whenever the difficulty changes\n\n    this.form.get(\"difficulty\")?.valueChanges.subscribe(value => {\n      this.setDifficulty(value);\n    });\n    this.authLoading = true;\n    const storedTokenString = localStorage.getItem(TOKEN_KEY);\n\n    if (storedTokenString) {\n      const storedToken = JSON.parse(storedTokenString);\n\n      if (storedToken.expiration > Date.now()) {\n        console.log(\"Token found in localstorage\");\n        this.authLoading = false;\n        this.token = storedToken.value;\n        this.loadGenres(storedToken.value);\n        return;\n      }\n    }\n\n    console.log(\"Sending request to AWS endpoint\");\n    request(AUTH_ENDPOINT).then(({\n      access_token,\n      expires_in\n    }) => {\n      const newToken = {\n        value: access_token,\n        expiration: Date.now() + (expires_in - 20) * 1000\n      };\n      localStorage.setItem(TOKEN_KEY, JSON.stringify(newToken));\n      this.authLoading = false;\n      this.token = newToken.value;\n      this.loadGenres(newToken.value);\n    });\n  }\n\n  setGenre(value) {\n    this.selectedGenre = value; // hide error message if genre is selected\n\n    if (value) {\n      this.showError = false;\n    }\n  }\n\n  setDifficulty(value) {\n    this.selectedDifficulty = value;\n    console.log(this.selectedDifficulty);\n  }\n\n  startGame() {\n    if (this.form.valid) {\n      this.playGame();\n    } else {\n      this.showError = true;\n    }\n  }\n\n  playGame() {\n    console.log(\"Navigating to play with state:\", {\n      difficulty: this.selectedDifficulty,\n      genre: this.selectedGenre,\n      token: this.token\n    });\n    this.router.navigate(['play'], {\n      state: {\n        choices: this.getNumberOfChoices(),\n        genre: this.selectedGenre,\n        token: this.token\n      }\n    });\n  }\n\n  getNumberOfChoices() {\n    switch (this.selectedDifficulty) {\n      case 'easy':\n        return 3;\n\n      case 'medium':\n        return 4;\n\n      case 'hard':\n        return 5;\n\n      default:\n        return 4;\n    }\n  }\n\n}\n\nHomeComponent.ɵfac = function HomeComponent_Factory(t) {\n  return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder));\n};\n\nHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HomeComponent,\n  selectors: [[\"app-home\"]],\n  decls: 13,\n  vars: 4,\n  consts: [[4, \"ngIf\"], [1, \"main-container\"], [1, \"selections\"], [3, \"formGroup\", 4, \"ngIf\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"buttonText\", \"Play\", 3, \"click\"], [\"buttonText\", \"Leaderboard\", \"routerLink\", \"/leaderboard\"], [\"buttonText\", \"Game Over\", \"routerLink\", \"/gameover\"], [3, \"formGroup\"], [\"formControlName\", \"genre\"], [3, \"value\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"formControlName\", \"difficulty\"], [\"value\", \"easy\"], [\"value\", \"medium\"], [\"value\", \"hard\"], [1, \"error-message\"]],\n  template: function HomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, HomeComponent_div_0_Template, 2, 0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\")(3, \"h1\");\n      i0.ɵɵtext(4, \"Who's Who\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"div\", 2);\n      i0.ɵɵtemplate(6, HomeComponent_div_6_Template, 5, 2, \"div\", 3);\n      i0.ɵɵtemplate(7, HomeComponent_div_7_Template, 9, 1, \"div\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(8, HomeComponent_div_8_Template, 3, 0, \"div\", 4);\n      i0.ɵɵelementStart(9, \"div\")(10, \"app-button\", 5);\n      i0.ɵɵlistener(\"click\", function HomeComponent_Template_app_button_click_10_listener() {\n        return ctx.startGame();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(11, \"app-button\", 6)(12, \"app-button\", 7);\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.authLoading || ctx.configLoading);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngIf\", !ctx.authLoading && !ctx.configLoading);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.authLoading && !ctx.configLoading);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.showError);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i1.RouterLink, i2.FormGroupDirective, i2.FormControlName, i4.ButtonComponent],\n  styles: [\"@import url(\\\"https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap\\\");\\n\\nbody[_ngcontent-%COMP%] {\\r\\n  font-family: \\\"Source Code Pro\\\", monospace;\\r\\n  color: #b3b3b3;\\r\\n  overflow-x: hidden;\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  background-color: #212121;\\r\\n}\\n\\n[_ngcontent-%COMP%]:root {\\r\\n  --arrow-bg: #486581;\\r\\n  --arrow-icon: url(https://upload.wikimedia.org/wikipedia/commons/9/9d/Caret_down_font_awesome_whitevariation.svg);\\r\\n  --option-bg: white;\\r\\n  --select-bg: rgba(255, 255, 255, 0.2);\\r\\n}\\nselect[_ngcontent-%COMP%] {\\r\\n  \\r\\n  -webkit-appearance: none;\\r\\n          appearance: none;\\r\\n  border: 0;\\r\\n  outline: 0;\\r\\n  font: inherit;\\r\\n  \\r\\n  \\r\\n  padding: 1rem 4rem 1rem 1rem;\\r\\n  background: var(--arrow-icon) no-repeat right 0.8em center / 1.4em,\\r\\n    linear-gradient(to left, var(--arrow-bg) 3em, var(--select-bg) 3em);\\r\\n  color: rgb(0, 252, 17);\\r\\n  border-radius: 0.25em;\\r\\n  box-shadow: 0 0 1em 0 rgba(0, 0, 0, 0.2);\\r\\n  cursor: pointer;\\r\\n  \\r\\n  &::-ms-expand {\\r\\n    display: none;\\r\\n  }\\r\\n  \\r\\n  &:focus {\\r\\n    outline: none;\\r\\n  }\\r\\n  \\r\\n  option {\\r\\n    color: black;\\r\\n    background-color: var(--option-bg);\\r\\n  }\\r\\n}\\n.main-container[_ngcontent-%COMP%] {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  align-items: center;\\r\\n  justify-content: center;\\r\\n  height: 100vh;\\r\\n}\\n\\n.button[_ngcontent-%COMP%] {\\r\\n  -webkit-appearance: button;\\r\\n          appearance: button;\\r\\n  -webkit-backface-visibility: hidden;\\r\\n          backface-visibility: hidden;\\r\\n  background-color: #486581;\\r\\n  border-radius: 6px;\\r\\n  border-width: 0;\\r\\n  box-shadow: rgba(50, 50, 93, 0.1) 0 0 0 1px inset,\\r\\n    rgba(50, 50, 93, 0.1) 0 2px 5px 0, rgba(0, 0, 0, 0.07) 0 1px 1px 0;\\r\\n  box-sizing: border-box;\\r\\n  color: #fff;\\r\\n  cursor: pointer;\\r\\n  font-family: \\\"Source Code Pro\\\", monospace;\\r\\n  font-size: 100%;\\r\\n  height: 44px;\\r\\n  line-height: 1.15;\\r\\n  margin: 12px 0 0;\\r\\n  outline: none;\\r\\n  overflow: hidden;\\r\\n  padding: 0 25px;\\r\\n  position: relative;\\r\\n  text-align: center;\\r\\n  text-transform: none;\\r\\n  transform: translateZ(0);\\r\\n  transition: all 0.2s, box-shadow 0.08s ease-in;\\r\\n  user-select: none;\\r\\n  -webkit-user-select: none;\\r\\n  touch-action: manipulation;\\r\\n  width: 100%;\\r\\n}\\n.button[_ngcontent-%COMP%]:disabled {\\r\\n  cursor: default;\\r\\n}\\n.button[_ngcontent-%COMP%]:focus {\\r\\n  box-shadow: rgba(50, 50, 93, 0.1) 0 0 0 1px inset,\\r\\n    rgba(50, 50, 93, 0.2) 0 6px 15px 0, rgba(0, 0, 0, 0.1) 0 2px 2px 0,\\r\\n    rgba(50, 151, 211, 0.3) 0 0 0 4px;\\r\\n}\\n.selections[_ngcontent-%COMP%] {\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    justify-content: space-between;\\r\\n    margin-bottom: 20px;\\r\\n    gap: 20px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3N0eWxlcy5jc3MiLCJob21lLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLG9IQUFvSDtBQURwSCw4RUFBOEU7QUFHOUU7RUFDRSx5Q0FBeUM7RUFDekMsY0FBYztFQUNkLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsVUFBVTtFQUNWLHlCQUF5QjtBQUMzQjtBQUVBLGlEQUFpRDtBQUVqRDtFQUNFLG1CQUFtQjtFQUNuQixpSEFBaUg7RUFDakgsa0JBQWtCO0VBQ2xCLHFDQUFxQztBQUN2QztBQUVBO0VBQ0UsVUFBVTtFQUNWLHdCQUFnQjtVQUFoQixnQkFBZ0I7RUFDaEIsU0FBUztFQUNULFVBQVU7RUFDVixhQUFhO0VBQ2IsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtFQUNsQiw0QkFBNEI7RUFDNUI7dUVBQ3FFO0VBQ3JFLHNCQUFzQjtFQUN0QixxQkFBcUI7RUFDckIsd0NBQXdDO0VBQ3hDLGVBQWU7RUFDZixvQkFBb0I7RUFDcEI7SUFDRSxhQUFhO0VBQ2Y7RUFDQSx5QkFBeUI7RUFDekI7SUFDRSxhQUFhO0VBQ2Y7RUFDQSxvQkFBb0I7RUFDcEI7SUFDRSxZQUFZO0lBQ1osa0NBQWtDO0VBQ3BDO0FBQ0Y7QUFFQTtFQUNFLGFBQWE7RUFDYixzQkFBc0I7RUFDdEIsbUJBQW1CO0VBQ25CLHVCQUF1QjtFQUN2QixhQUFhO0FBQ2Y7QUFFQSw0REFBNEQ7QUFFNUQ7RUFDRSwwQkFBa0I7VUFBbEIsa0JBQWtCO0VBQ2xCLG1DQUEyQjtVQUEzQiwyQkFBMkI7RUFDM0IseUJBQXlCO0VBQ3pCLGtCQUFrQjtFQUNsQixlQUFlO0VBQ2Y7c0VBQ29FO0VBQ3BFLHNCQUFzQjtFQUN0QixXQUFXO0VBQ1gsZUFBZTtFQUNmLHlDQUF5QztFQUN6QyxlQUFlO0VBQ2YsWUFBWTtFQUNaLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLGdCQUFnQjtFQUNoQixlQUFlO0VBQ2Ysa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixvQkFBb0I7RUFDcEIsd0JBQXdCO0VBQ3hCLDhDQUE4QztFQUM5QyxpQkFBaUI7RUFDakIseUJBQXlCO0VBQ3pCLDBCQUEwQjtFQUMxQixXQUFXO0FBQ2I7QUFFQTtFQUNFLGVBQWU7QUFDakI7QUFFQTtFQUNFOztxQ0FFbUM7QUFDckM7QUNqR0E7SUFDSSxhQUFhO0lBQ2IsbUJBQW1CO0lBQ25CLDhCQUE4QjtJQUM5QixtQkFBbUI7SUFDbkIsU0FBUztBQUNiIiwiZmlsZSI6ImhvbWUuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIFlvdSBjYW4gYWRkIGdsb2JhbCBzdHlsZXMgdG8gdGhpcyBmaWxlLCBhbmQgYWxzbyBpbXBvcnQgb3RoZXIgc3R5bGUgZmlsZXMgKi9cclxuQGltcG9ydCB1cmwoXCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PVNvdXJjZStDb2RlK1BybzppdGFsLHdnaHRAMCwyMDAuLjkwMDsxLDIwMC4uOTAwJmRpc3BsYXk9c3dhcFwiKTtcclxuXHJcbmJvZHkge1xyXG4gIGZvbnQtZmFtaWx5OiBcIlNvdXJjZSBDb2RlIFByb1wiLCBtb25vc3BhY2U7XHJcbiAgY29sb3I6ICNiM2IzYjM7XHJcbiAgb3ZlcmZsb3cteDogaGlkZGVuO1xyXG4gIG1hcmdpbjogMDtcclxuICBwYWRkaW5nOiAwO1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICMyMTIxMjE7XHJcbn1cclxuXHJcbi8qIGZyb206IGh0dHBzOi8vY29kZXBlbi5pby9yYXViYWNhL3Blbi9iR1dtWmplICovXHJcblxyXG46cm9vdCB7XHJcbiAgLS1hcnJvdy1iZzogIzQ4NjU4MTtcclxuICAtLWFycm93LWljb246IHVybChodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zLzkvOWQvQ2FyZXRfZG93bl9mb250X2F3ZXNvbWVfd2hpdGV2YXJpYXRpb24uc3ZnKTtcclxuICAtLW9wdGlvbi1iZzogd2hpdGU7XHJcbiAgLS1zZWxlY3QtYmc6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTtcclxufVxyXG5cclxuc2VsZWN0IHtcclxuICAvKiBSZXNldCAqL1xyXG4gIGFwcGVhcmFuY2U6IG5vbmU7XHJcbiAgYm9yZGVyOiAwO1xyXG4gIG91dGxpbmU6IDA7XHJcbiAgZm9udDogaW5oZXJpdDtcclxuICAvKiBQZXJzb25hbGl6ZSAqL1xyXG4gIC8qIHdpZHRoOiAyMHJlbTsgKi9cclxuICBwYWRkaW5nOiAxcmVtIDRyZW0gMXJlbSAxcmVtO1xyXG4gIGJhY2tncm91bmQ6IHZhcigtLWFycm93LWljb24pIG5vLXJlcGVhdCByaWdodCAwLjhlbSBjZW50ZXIgLyAxLjRlbSxcclxuICAgIGxpbmVhci1ncmFkaWVudCh0byBsZWZ0LCB2YXIoLS1hcnJvdy1iZykgM2VtLCB2YXIoLS1zZWxlY3QtYmcpIDNlbSk7XHJcbiAgY29sb3I6IHJnYigwLCAyNTIsIDE3KTtcclxuICBib3JkZXItcmFkaXVzOiAwLjI1ZW07XHJcbiAgYm94LXNoYWRvdzogMCAwIDFlbSAwIHJnYmEoMCwgMCwgMCwgMC4yKTtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgLyogUmVtb3ZlIElFIGFycm93ICovXHJcbiAgJjo6LW1zLWV4cGFuZCB7XHJcbiAgICBkaXNwbGF5OiBub25lO1xyXG4gIH1cclxuICAvKiBSZW1vdmUgZm9jdXMgb3V0bGluZSAqL1xyXG4gICY6Zm9jdXMge1xyXG4gICAgb3V0bGluZTogbm9uZTtcclxuICB9XHJcbiAgLyogPG9wdGlvbj4gY29sb3JzICovXHJcbiAgb3B0aW9uIHtcclxuICAgIGNvbG9yOiBibGFjaztcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLW9wdGlvbi1iZyk7XHJcbiAgfVxyXG59XHJcblxyXG4ubWFpbi1jb250YWluZXIge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gIGhlaWdodDogMTAwdmg7XHJcbn1cclxuXHJcbi8qIFRha2VuIGZyb206IGh0dHBzOi8vZ2V0Y3Nzc2Nhbi5jb20vY3NzLWJ1dHRvbnMtZXhhbXBsZXMgKi9cclxuXHJcbi5idXR0b24ge1xyXG4gIGFwcGVhcmFuY2U6IGJ1dHRvbjtcclxuICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzQ4NjU4MTtcclxuICBib3JkZXItcmFkaXVzOiA2cHg7XHJcbiAgYm9yZGVyLXdpZHRoOiAwO1xyXG4gIGJveC1zaGFkb3c6IHJnYmEoNTAsIDUwLCA5MywgMC4xKSAwIDAgMCAxcHggaW5zZXQsXHJcbiAgICByZ2JhKDUwLCA1MCwgOTMsIDAuMSkgMCAycHggNXB4IDAsIHJnYmEoMCwgMCwgMCwgMC4wNykgMCAxcHggMXB4IDA7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBjb2xvcjogI2ZmZjtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgZm9udC1mYW1pbHk6IFwiU291cmNlIENvZGUgUHJvXCIsIG1vbm9zcGFjZTtcclxuICBmb250LXNpemU6IDEwMCU7XHJcbiAgaGVpZ2h0OiA0NHB4O1xyXG4gIGxpbmUtaGVpZ2h0OiAxLjE1O1xyXG4gIG1hcmdpbjogMTJweCAwIDA7XHJcbiAgb3V0bGluZTogbm9uZTtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIHBhZGRpbmc6IDAgMjVweDtcclxuICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIHRleHQtdHJhbnNmb3JtOiBub25lO1xyXG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlWigwKTtcclxuICB0cmFuc2l0aW9uOiBhbGwgMC4ycywgYm94LXNoYWRvdyAwLjA4cyBlYXNlLWluO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG4gIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgdG91Y2gtYWN0aW9uOiBtYW5pcHVsYXRpb247XHJcbiAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbi5idXR0b246ZGlzYWJsZWQge1xyXG4gIGN1cnNvcjogZGVmYXVsdDtcclxufVxyXG5cclxuLmJ1dHRvbjpmb2N1cyB7XHJcbiAgYm94LXNoYWRvdzogcmdiYSg1MCwgNTAsIDkzLCAwLjEpIDAgMCAwIDFweCBpbnNldCxcclxuICAgIHJnYmEoNTAsIDUwLCA5MywgMC4yKSAwIDZweCAxNXB4IDAsIHJnYmEoMCwgMCwgMCwgMC4xKSAwIDJweCAycHggMCxcclxuICAgIHJnYmEoNTAsIDE1MSwgMjExLCAwLjMpIDAgMCAwIDRweDtcclxufVxyXG4iLCJAaW1wb3J0ICcuLi8uLi9zdHlsZXMuY3NzJztcclxuXHJcbi5zZWxlY3Rpb25zIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMjBweDtcclxuICAgIGdhcDogMjBweDtcclxufVxyXG4iXX0= */\"]\n});","map":{"version":3,"mappings":";AACA,SAA2BA,OAA3B,QAA0C,oBAA1C;AAEA,SAAiCC,UAAjC,QAAmD,gBAAnD;;;;;;;;;ICHAC;IAA0CA;IAAUA;;;;;;IAY5CA;IACEA;IACFA;;;;;IAFQA;IACNA;IAAAA;;;;;;IALNA;IACEA;IACAA;IACEA;IACAA;IAGFA;;;;;IAP0CA;IAIEA;IAAAA;;;;;;IAM9CA;IACEA;IACAA,mCAAqC,CAArC,EAAqC,QAArC,EAAqC,EAArC;IACuBA;IAAIA;IACzBA;IAAuBA;IAAMA;IAC7BA;IAAqBA;IAAIA;;;;;IALeA;;;;;;IAU9CA,gCAA6C,CAA7C,EAA6C,GAA7C;IACKA;IAA+CA;;;;ADxBtD,MAAMC,aAAa,GACjB,wFADF;AAEA,MAAMC,SAAS,GAAG,uBAAlB;AAOA,OAAM,MAAOC,aAAP,CAAoB;EAUxBC,YAAoBC,MAApB,EAA4CC,EAA5C,EAA2D;IAAA;;IAAvC;IAAwB;IAR5C,iBAAqB,KAArB;IACA,cAAmB,EAAnB;IACA,qBAAwB,EAAxB;IACA,0BAAqB,QAArB;IACA,mBAAuB,KAAvB;IACA,qBAAyB,KAAzB;IACA,aAAgB,EAAhB;;IA6CA;MAAA,6BAAa,WAAOC,CAAP,EAAiB;QAC5B,KAAI,CAACC,aAAL,GAAqB,IAArB;QACA,KAAI,CAACC,MAAL,GAAc,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,EAAyB,SAAzB,EAAoC,QAApC,EAA8C,KAA9C,CAAd;QACA,KAAI,CAACD,aAAL,GAAqB,KAArB;MACD,CAJD;;MAAA;QAAA;MAAA;IAAA;;IA1CE,KAAKE,IAAL,GAAY,KAAKJ,EAAL,CAAQK,KAAR,CAAc;MACxBC,KAAK,EAAE,CAAC,EAAD,EAAKb,UAAU,CAACc,QAAhB,CADiB;MAExBC,UAAU,EAAE,CAAC,KAAKC,kBAAN,EAA0BhB,UAAU,CAACc,QAArC;IAFY,CAAd,CAAZ;EAID;;EAEDG,QAAQ;IACN;IACA,KAAKN,IAAL,CAAUO,GAAV,CAAc,OAAd,GAAwBC,YAAxB,CAAqCC,SAArC,CAAgDC,KAAD,IAAU;MACvD,KAAKC,QAAL,CAAcD,KAAd;IACD,CAFD,EAFM,CAMN;;IACA,KAAKV,IAAL,CAAUO,GAAV,CAAc,YAAd,GAA6BC,YAA7B,CAA0CC,SAA1C,CAAqDC,KAAD,IAAU;MAC5D,KAAKE,aAAL,CAAmBF,KAAnB;IACD,CAFD;IAIA,KAAKG,WAAL,GAAmB,IAAnB;IACA,MAAMC,iBAAiB,GAAGC,YAAY,CAACC,OAAb,CAAqBxB,SAArB,CAA1B;;IACA,IAAIsB,iBAAJ,EAAuB;MACrB,MAAMG,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWL,iBAAX,CAApB;;MACA,IAAIG,WAAW,CAACG,UAAZ,GAAyBC,IAAI,CAACC,GAAL,EAA7B,EAAyC;QACvCC,OAAO,CAACC,GAAR,CAAY,6BAAZ;QACA,KAAKX,WAAL,GAAmB,KAAnB;QACA,KAAKY,KAAL,GAAaR,WAAW,CAACP,KAAzB;QACA,KAAKgB,UAAL,CAAgBT,WAAW,CAACP,KAA5B;QACA;MACD;IACF;;IACDa,OAAO,CAACC,GAAR,CAAY,iCAAZ;IACApC,OAAO,CAACG,aAAD,CAAP,CAAuBoC,IAAvB,CAA4B,CAAC;MAAEC,YAAF;MAAgBC;IAAhB,CAAD,KAAiC;MAC3D,MAAMC,QAAQ,GAAG;QACfpB,KAAK,EAAEkB,YADQ;QAEfR,UAAU,EAAEC,IAAI,CAACC,GAAL,KAAa,CAACO,UAAU,GAAG,EAAd,IAAoB;MAF9B,CAAjB;MAIAd,YAAY,CAACgB,OAAb,CAAqBvC,SAArB,EAAgC0B,IAAI,CAACc,SAAL,CAAeF,QAAf,CAAhC;MACA,KAAKjB,WAAL,GAAmB,KAAnB;MACA,KAAKY,KAAL,GAAaK,QAAQ,CAACpB,KAAtB;MACA,KAAKgB,UAAL,CAAgBI,QAAQ,CAACpB,KAAzB;IACD,CATD;EAUD;;EAQDC,QAAQ,CAACD,KAAD,EAAc;IACpB,KAAKuB,aAAL,GAAqBvB,KAArB,CADoB,CAEpB;;IACA,IAAIA,KAAJ,EAAW;MACT,KAAKwB,SAAL,GAAiB,KAAjB;IACD;EACF;;EAEDtB,aAAa,CAACF,KAAD,EAAc;IACzB,KAAKL,kBAAL,GAA0BK,KAA1B;IACAa,OAAO,CAACC,GAAR,CAAY,KAAKnB,kBAAjB;EACD;;EACD8B,SAAS;IACP,IAAI,KAAKnC,IAAL,CAAUoC,KAAd,EAAqB;MACnB,KAAKC,QAAL;IACD,CAFD,MAEO;MACL,KAAKH,SAAL,GAAiB,IAAjB;IACD;EACF;;EACDG,QAAQ;IACNd,OAAO,CAACC,GAAR,CAAY,gCAAZ,EAA8C;MAC5CpB,UAAU,EAAE,KAAKC,kBAD2B;MAE5CH,KAAK,EAAE,KAAK+B,aAFgC;MAG5CR,KAAK,EAAE,KAAKA;IAHgC,CAA9C;IAKA,KAAK9B,MAAL,CAAY2C,QAAZ,CAAqB,CAAC,MAAD,CAArB,EAA8B;MAC5BC,KAAK,EAAE;QACLC,OAAO,EAAE,KAAKC,kBAAL,EADJ;QAELvC,KAAK,EAAE,KAAK+B,aAFP;QAGLR,KAAK,EAAE,KAAKA;MAHP;IADqB,CAA9B;EAOD;;EACDgB,kBAAkB;IAChB,QAAQ,KAAKpC,kBAAb;MACE,KAAK,MAAL;QACE,OAAO,CAAP;;MACF,KAAK,QAAL;QACE,OAAO,CAAP;;MACF,KAAK,MAAL;QACE,OAAO,CAAP;;MACF;QACE,OAAO,CAAP;IARJ;EAUD;;AAvGuB;;;mBAAbZ,eAAaH;AAAA;;;QAAbG;EAAaiD;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCd1BxD;MAEAA,+BAA4B,CAA5B,EAA4B,KAA5B,EAA4B,CAA5B,EAA4B,IAA5B;MAEQA;MAASA;MAGfA;MACEA;MAUAA;MAQFA;MAEAA;MAIAA,4BAAK,EAAL,EAAK,YAAL,EAAK,CAAL;MACgCA;QAAA,OAASyD,eAAT;MAAoB,CAApB;MAAsBzD;MACpDA,kCAA4E,EAA5E,EAA4E,YAA5E,EAA4E,CAA5E;MAEFA;;;;MApCIA;MAQIA;MAAAA;MAUAA;MAAAA;MAUFA;MAAAA","names":["request","Validators","i0","AUTH_ENDPOINT","TOKEN_KEY","HomeComponent","constructor","router","fb","t","configLoading","genres","form","group","genre","required","difficulty","selectedDifficulty","ngOnInit","get","valueChanges","subscribe","value","setGenre","setDifficulty","authLoading","storedTokenString","localStorage","getItem","storedToken","JSON","parse","expiration","Date","now","console","log","token","loadGenres","then","access_token","expires_in","newToken","setItem","stringify","selectedGenre","showError","startGame","valid","playGame","navigate","state","choices","getNumberOfChoices","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["M:\\August Cohort\\angular-whos-who-aug-2024-team-4\\src\\app\\home\\home.component.ts","M:\\August Cohort\\angular-whos-who-aug-2024-team-4\\src\\app\\home\\home.component.html"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\r\nimport fetchFromSpotify, { request } from \"../../services/api\";\r\nimport { Router } from \"@angular/router\";\r\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\r\n\r\nconst AUTH_ENDPOINT =\r\n  \"https://nuod0t2zoe.execute-api.us-east-2.amazonaws.com/FT-Classroom/spotify-auth-token\";\r\nconst TOKEN_KEY = \"whos-who-access-token\";\r\n\r\n@Component({\r\n  selector: \"app-home\",\r\n  templateUrl: \"./home.component.html\",\r\n  styleUrls: [\"./home.component.css\"],\r\n})\r\nexport class HomeComponent implements OnInit {\r\n  form: FormGroup;\r\n  showError: boolean = false;\r\n  genres: String[] = [];\r\n  selectedGenre: String = \"\";\r\n  selectedDifficulty = \"medium\";\r\n  authLoading: boolean = false;\r\n  configLoading: boolean = false;\r\n  token: String = \"\";\r\n\r\n  constructor(private router: Router, private fb: FormBuilder) {\r\n    this.form = this.fb.group({\r\n      genre: [\"\", Validators.required],\r\n      difficulty: [this.selectedDifficulty, Validators.required],\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    // Subscribe to valueChanges to call setGenre() whenever the genre changes\r\n    this.form.get(\"genre\")?.valueChanges.subscribe((value) => {\r\n      this.setGenre(value);\r\n    });\r\n\r\n    // Subscribe to valueChanges to call setDifficulty() whenever the difficulty changes\r\n    this.form.get(\"difficulty\")?.valueChanges.subscribe((value) => {\r\n      this.setDifficulty(value);\r\n    });\r\n\r\n    this.authLoading = true;\r\n    const storedTokenString = localStorage.getItem(TOKEN_KEY);\r\n    if (storedTokenString) {\r\n      const storedToken = JSON.parse(storedTokenString);\r\n      if (storedToken.expiration > Date.now()) {\r\n        console.log(\"Token found in localstorage\");\r\n        this.authLoading = false;\r\n        this.token = storedToken.value;\r\n        this.loadGenres(storedToken.value);\r\n        return;\r\n      }\r\n    }\r\n    console.log(\"Sending request to AWS endpoint\");\r\n    request(AUTH_ENDPOINT).then(({ access_token, expires_in }) => {\r\n      const newToken = {\r\n        value: access_token,\r\n        expiration: Date.now() + (expires_in - 20) * 1000,\r\n      };\r\n      localStorage.setItem(TOKEN_KEY, JSON.stringify(newToken));\r\n      this.authLoading = false;\r\n      this.token = newToken.value;\r\n      this.loadGenres(newToken.value);\r\n    });\r\n  }\r\n\r\n  loadGenres = async (t: any) => {\r\n    this.configLoading = true;\r\n    this.genres = [\"Pop\", \"Rock\", \"J-pop\", \"Country\", \"HipHop\", \"EDM\"];\r\n    this.configLoading = false;\r\n  };\r\n\r\n  setGenre(value: string): void {\r\n    this.selectedGenre = value;\r\n    // hide error message if genre is selected\r\n    if (value) {\r\n      this.showError = false;\r\n    }\r\n  }\r\n\r\n  setDifficulty(value: string): void {\r\n    this.selectedDifficulty = value;\r\n    console.log(this.selectedDifficulty);\r\n  }\r\n  startGame() {\r\n    if (this.form.valid) {\r\n      this.playGame();\r\n    } else {\r\n      this.showError = true;\r\n    }\r\n  }\r\n  playGame(){\r\n    console.log(\"Navigating to play with state:\", {\r\n      difficulty: this.selectedDifficulty,\r\n      genre: this.selectedGenre,\r\n      token: this.token,\r\n    });\r\n    this.router.navigate(['play'],{\r\n      state: {\r\n        choices: this.getNumberOfChoices(),\r\n        genre: this.selectedGenre,\r\n        token: this.token\r\n      }\r\n    })\r\n  }\r\n  getNumberOfChoices() {\r\n    switch (this.selectedDifficulty) {\r\n      case 'easy':\r\n        return 3;\r\n      case 'medium':\r\n        return 4;\r\n      case 'hard':\r\n        return 5;\r\n      default:\r\n        return 4;\r\n    }\r\n  }\r\n}\r\n","<div *ngIf=\"authLoading || configLoading\">Loading...</div>\r\n\r\n<div class=\"main-container\">\r\n  <div>\r\n    <h1>Who's Who</h1>\r\n  </div>\r\n\r\n  <div class=\"selections\">\r\n    <div *ngIf=\"!authLoading && !configLoading\" [formGroup]=\"form\">\r\n      Genre:\r\n      <select formControlName=\"genre\">\r\n        <option [value]=\"\"></option>\r\n        <option [value]=\"genre\" *ngFor=\"let genre of genres\">\r\n          {{ genre }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n\r\n    <div *ngIf=\"!authLoading && !configLoading\" [formGroup]=\"form\">\r\n      Difficulty:\r\n      <select formControlName=\"difficulty\">\r\n        <option value=\"easy\">Easy</option>\r\n        <option value=\"medium\">Medium</option>\r\n        <option value=\"hard\">Hard</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n\r\n  <div *ngIf=\"showError\" class=\"error-message\">\r\n    <p>Please select a genre before starting the game.</p>\r\n  </div>\r\n\r\n  <div>\r\n    <app-button buttonText=\"Play\" (click)=\"startGame()\"></app-button>\r\n    <app-button buttonText=\"Leaderboard\" routerLink=\"/leaderboard\"></app-button>\r\n    <app-button buttonText=\"Game Over\" routerLink=\"/gameover\"></app-button>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module"}